!function(t,e){function i(t){return"number"==typeof t}function n(t){return t!==o&&null!==t}var o,s,a,r=t.Chart,l=t.extend,h=t.each;a=["path","rect","circle"],s={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var p=e.inArray,c=t.merge,d=function(){this.init.apply(this,arguments)};d.prototype={init:function(t,e){var i=e.shape&&e.shape.type;this.chart=t;var n,o;o={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}},n={circle:{params:{x:0,y:0}}},n[i]&&(o.shape=c(o.shape,n[i])),this.options=c({},o,e)},render:function(t){var e=this.chart,i=this.chart.renderer,n=this.group,o=this.title,s=this.shape,r=this.options,l=r.title,h=r.shape;n||(n=this.group=i.g()),!s&&h&&-1!==p(h.type,a)&&(s=this.shape=i[r.shape.type](h.params),s.add(n)),!o&&l&&(o=this.title=i.label(l),o.add(n)),n.add(e.annotations.group),this.linkObjects(),t!==!1&&this.redraw()},redraw:function(){var e,o,a,r,h=this.options,c=this.chart,d=this.group,u=this.title,f=this.shape,g=this.linkedObject,m=c.xAxis[h.xAxis],y=c.yAxis[h.yAxis],b=h.width,w=h.height,v=s[h.anchorY],x=s[h.anchorX];if(g&&(e=g instanceof t.Point?"point":g instanceof t.Series?"series":null,"point"===e?(h.xValue=g.x,h.yValue=g.y,o=g.series):"series"===e&&(o=g),d.visibility!==o.group.visibility&&d.attr({visibility:o.group.visibility})),g=n(h.xValue)?m.toPixels(h.xValue+m.minPointOffset)-m.minPixelPadding:h.x,e=n(h.yValue)?y.toPixels(h.yValue):h.y,!isNaN(g)&&!isNaN(e)&&i(g)&&i(e)){if(u&&(u.attr(h.title),u.css(h.title.style)),f){if(u=l({},h.shape.params),"values"===h.units){for(a in u)p(a,["width","x"])>-1?u[a]=m.translate(u[a]):p(a,["height","y"])>-1&&(u[a]=y.translate(u[a]));if(u.width&&(u.width-=m.toPixels(0)-m.left),u.x&&(u.x+=m.minPixelPadding),"path"===h.shape.type){a=u.d,o=g;for(var A=e,P=a.length,L=0;P>L;)"number"==typeof a[L]&&"number"==typeof a[L+1]?(a[L]=m.toPixels(a[L])-o,a[L+1]=y.toPixels(a[L+1])-A,L+=2):L+=1}}"circle"===h.shape.type&&(u.x+=u.r,u.y+=u.r),f.attr(u)}d.bBox=null,i(b)||(r=d.getBBox(),b=r.width),i(w)||(r||(r=d.getBBox()),w=r.height),i(x)||(x=s.center),i(v)||(v=s.center),g-=b*x,e-=w*v,c.animation&&n(d.translateX)&&n(d.translateY)?d.animate({translateX:g,translateY:e}):d.translate(g,e)}},destroy:function(){var t=this,e=this.chart.annotations.allItems,i=e.indexOf(t);i>-1&&e.splice(i,1),h(["title","shape","group"],function(e){t[e]&&(t[e].destroy(),t[e]=null)}),t.group=t.title=t.shape=t.chart=t.options=null},update:function(t,e){l(this.options,t),this.linkObjects(),this.render(e)},linkObjects:function(){var t=this.chart,e=this.linkedObject,i=e&&(e.id||e.options.id),o=this.options.linkedTo;n(o)?n(e)&&o===i||(this.linkedObject=t.get(o)):this.linkedObject=null}},l(r.prototype,{annotations:{add:function(t,e){var i,n,o=this.allItems,s=this.chart;for("[object Array]"===Object.prototype.toString.call(t)||(t=[t]),n=t.length;n--;)i=new d(s,t[n]),o.push(i),i.render(e)},redraw:function(){h(this.allItems,function(t){t.redraw()})}}}),r.prototype.callbacks.push(function(e){var i,n=e.options.annotations;i=e.renderer.g("annotations"),i.attr({zIndex:7}),i.add(),e.annotations.allItems=[],e.annotations.chart=e,e.annotations.group=i,"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&e.annotations.add(e.options.annotations),t.addEvent(e,"redraw",function(){e.annotations.redraw()})})}(Highcharts,HighchartsAdapter);