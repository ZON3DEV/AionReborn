!function(t){var e=t.each,i=function(t,e){this.init(t,e)};t.extend(i.prototype,{init:function(t,e){this.options=t,this.chartOptions=e,this.columns=t.columns||this.rowsToColumns(t.rows)||[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var i=this.chartOptions,n=i&&i.chart&&i.chart.type,o=[];e(i&&i.series||[],function(e){o.push((t.seriesTypes[e.type||n||"line"].prototype.pointArrayMap||[0]).length)}),this.valueCount={global:(t.seriesTypes[n||"line"].prototype.pointArrayMap||[0]).length,individual:o}},dataFound:function(){this.parseTypes(),this.findHeaderRow(),this.parsed(),this.complete()},parseCSV:function(){var t=this,i=this.options,n=i.csv,o=this.columns,s=i.startRow||0,r=i.endRow||Number.MAX_VALUE,a=i.startColumn||0,l=i.endColumn||Number.MAX_VALUE,h=0;n&&(n=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(i.lineDelimiter||"\n"),e(n,function(n,c){var p=t.trim(n),d=0===p.indexOf("#");c>=s&&r>=c&&!d&&""!==p&&(p=n.split(i.itemDelimiter||","),e(p,function(t,e){e>=a&&l>=e&&(o[e-a]||(o[e-a]=[]),o[e-a][h]=t)}),h+=1)}),this.dataFound())},parseTable:function(){var t,i=this.options,n=i.table,o=this.columns,s=i.startRow||0,r=i.endRow||Number.MAX_VALUE,a=i.startColumn||0,l=i.endColumn||Number.MAX_VALUE;n&&("string"==typeof n&&(n=document.getElementById(n)),e(n.getElementsByTagName("tr"),function(i,n){t=0,n>=s&&r>=n&&e(i.childNodes,function(e){("TD"===e.tagName||"TH"===e.tagName)&&t>=a&&l>=t&&(o[t]||(o[t]=[]),o[t][n-s]=e.innerHTML,t+=1)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var t,e,i=this,n=this.options,o=n.googleSpreadsheetKey,s=this.columns,r=n.startRow||0,a=n.endRow||Number.MAX_VALUE,l=n.startColumn||0,h=n.endColumn||Number.MAX_VALUE;o&&jQuery.getJSON("https://spreadsheets.google.com/feeds/cells/"+o+"/"+(n.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",function(n){var o,c,n=n.feed.entry,p=n.length,d=0,u=0;for(c=0;p>c;c++)o=n[c],d=Math.max(d,o.gs$cell.col),u=Math.max(u,o.gs$cell.row);for(c=0;d>c;c++)c>=l&&h>=c&&(s[c-l]=[],s[c-l].length=Math.min(u,a-r));for(c=0;p>c;c++)o=n[c],t=o.gs$cell.row-1,e=o.gs$cell.col-1,e>=l&&h>=e&&t>=r&&a>=t&&(s[e-l][t-r]=o.content.$t);i.dataFound()})},findHeaderRow:function(){e(this.columns,function(){}),this.headerRow=0},trim:function(t){return"string"==typeof t?t.replace(/^\s+|\s+$/g,""):t},parseTypes:function(){for(var t,e,i,n,o=this.columns,s=o.length;s--;)for(t=o[s].length;t--;)e=o[s][t],i=parseFloat(e),n=this.trim(e),n==i?(o[s][t]=i,i>31536e6?o[s].isDatetime=!0:o[s].isNumeric=!0):(e=this.parseDate(e),0!==s||"number"!=typeof e||isNaN(e)?o[s][t]=""===n?null:n:(o[s][t]=e,o[s].isDatetime=!0))},dateFormats:{"YYYY-mm-dd":{regex:"^([0-9]{4})-([0-9]{2})-([0-9]{2})$",parser:function(t){return Date.UTC(+t[1],t[2]-1,+t[3])}}},parseDate:function(t){var e,i,n,o=this.options.parseDate;if(o&&(e=o(t)),"string"==typeof t)for(i in this.dateFormats)o=this.dateFormats[i],(n=t.match(o.regex))&&(e=o.parser(n));return e},rowsToColumns:function(t){var e,i,n,o,s;if(t)for(s=[],i=t.length,e=0;i>e;e++)for(o=t[e].length,n=0;o>n;n++)s[n]||(s[n]=[]),s[n][e]=t[e][n];return s},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var e,i,n,o,s,r,a,l,h=this.columns,c=this.options;if(c.complete){for(this.getColumnDistribution(),h.length>1&&(e=h.shift(),0===this.headerRow&&e.shift(),e.isDatetime?i="datetime":e.isNumeric||(i="category")),r=0;r<h.length;r++)0===this.headerRow&&(h[r].name=h[r].shift());for(o=[],r=0,l=0;r<h.length;l++){for(n=t.pick(this.valueCount.individual[l],this.valueCount.global),s=[],a=0;a<h[r].length;a++)s[a]=[e[a],void 0!==h[r][a]?h[r][a]:null],n>1&&s[a].push(void 0!==h[r+1][a]?h[r+1][a]:null),n>2&&s[a].push(void 0!==h[r+2][a]?h[r+2][a]:null),n>3&&s[a].push(void 0!==h[r+3][a]?h[r+3][a]:null),n>4&&s[a].push(void 0!==h[r+4][a]?h[r+4][a]:null);o[l]={name:h[r].name,data:s},r+=n}c.complete({xAxis:{type:i},series:o})}}}),t.Data=i,t.data=function(t,e){return new i(t,e)},t.wrap(t.Chart.prototype,"init",function(i,n,o){var s=this;n&&n.data?t.data(t.extend(n.data,{complete:function(r){n.series&&e(n.series,function(e,i){n.series[i]=t.merge(e,r.series[i])}),n=t.merge(r,n),i.call(s,n,o)}}),n):i.call(s,n,o)})}(Highcharts);